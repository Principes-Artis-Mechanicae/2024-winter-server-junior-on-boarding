세션 로그인
-
http는 stateless이다.

stateless라 함은 서버로 가는 모든 요청이 이전 요청과 독립적으로 다뤄진다는 뜻이다. 요청끼리는 연결이 없다. 요청이 끝나면 서버는 잊어버린다. 그래서 요청할 때마다 우리가 누군지 알려줘야하는데, 이것을 수행하는 방법 중 하나가 세션이다. 세션은 stateful한 특성을 가진다.

예를 들자면, 우리가 로그인을 할 때, 아이디와 비번을 서버로 보낸다. 비번이 맞다면 서버는 세션 DB에 user를 생성한다. 해당 세션에는 별도의 ID가 존재한다. 해당 세션 ID는 쿠키를 통해 브라우저로 돌아오고 저장된다. 따라서, 같은 웹사이트의 다른 페이지로 이동하면 우리 브라우저는 세션ID를 갖고있는 쿠키를 서버에게 보낼 것이다. 그러면 서버는 들어오는 쿠키를 보고 세션ID와 함께 오는 쿠키를 확인한다. 아직까지 서버는 우리가 누군지 모른다. 단지 세션ID가 있는 쿠키를 지닌 요청이 있다는 것만 알 뿐이다. 해당 세션ID를 가지고 세션 DB를 확인할 것이고, 거기서 해당 ID는 우리임을 알게 된다. 해당 요청이 끝나고 다른 페이지로 이동하게 되면, 이 모든 프로세스가 반복된다.

중요한 유저 정보는 모두 서버에 존재한다. 유저가 갖고있는 것은 세션ID 뿐이다. 쿠키는 보다시피 그저 세션ID를 전달하기 위한 매개체일 뿐이다. 세션은 보다시피 요청이 있을 때마다 DB를 찾아야 하기 때문에, 유저가 늘어남에 따라 DB 리소스가 더 필요하다.

JWT 로그인
-
토큰은 서버에서 받아서 요청할 때마다 보내야 하는 이상하게 생긴 string이다.

JWT로 유저 인증을 처리하면, 세션DB를 가질 필요가 없고, 서버는 유저를 인증한다고 많은 일을 하지 않아도 된다.

세션과 같은 예시에서, 토큰은 유저로부터 받은 ID와 비밀번호 정보가 맞다면, 서버는 DB에 뭔가를 생성하는 대신 유저의 ID를 가져간다. 사인 알고리즘을 이용해서 사인을 한다. 그리고 해당 사인된 정보를 string 형태로 보낸다. 아래는 jwt의 모습이다.

​

eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5

​

보통의 세션ID 보다 훨씬 긴 것을 알 수 있다. 왜냐하면 쿠키는 공간에 제약이 있기 때문이다. 어쨋든, 토큰 방식은 DB를 건드리는 대신 정보를 사인하고 전달하는 것이 전부이다.

이제 서버에 요청을 보내려면, 해당 사인된 정보 혹은 토큰을 서버에 보내야 한다. 서버는 토큰 을 받으면 해당 사인이 유효한지 체크하고(사인이 조작되었는지 아닌지), 토큰이 유효하다면 서버는 우리를 유저로 인증한다.

JWT에선 서버는 유저를 인증하는데 필요한 정보를 토큰에 저장한다. 그리고 해당 토큰을 우리에게 준다. 페이지를 요청하면 DB를 거칠 필요없이 서버는 해당 토큰이 유효한지만 검증하면 된다.

JWT는 암호화되지 않았기 때문에, 누구나 열어서 해당 컨텐츠를 볼 수 있다. 그래서 비밀 정보를 JWT 안에 둬서는 안된다.

세션과 JWT의 장단점
-
세션을 사용하면 서버는 로그인 된 유저의 모든 정보를 저장한다. 해당 정보를 이용해 새로운 기능을 추가할 수 있다. 예를 들면 특정 유저를 out시키고 싶을 때, 그냥 해당 세션을 삭제시키면 된다. 혹은 인스타그램과 같이 로그인된 모든 디바이스를 보여주고, 원하지 않는 디바이스에서 강제로 로그아웃을 할 수 있다. 또 넷플릭스처럼 계정 공유 숫자를 제한 할 수 있다.

이를 위해선 DB를 사고 유지해야 한다. 그리고 유저가 늘어날수록 사용하는 DB도 늘어난다.

​

JWT를 사용하면, 생성된 토큰을 추적하지 않는다. 그냥 유효성 검사만 할 뿐이다. 그래서 DB가 필요없지만, 세션에서 말한 것과 같은 기능을 할 수 없다.

*주어진 과제에서는 추가 기능이나 따로 DB를 관리해야한다는 요구사항이 없으므로, JWT를 사용하겠습니다.